import os
import subprocess
from datetime import datetime

BASE_DIR = os.path.dirname(os.path.abspath(__file__))  # agora é a pasta codigos
CODIGOS_DIR = BASE_DIR
ECOMMERCE_DIR = os.path.dirname(BASE_DIR)

# Lista dos scripts a serem executados em ordem
scripts = [
    "1 novo scraper",
    "2 novo download de imagens",
    "3 novo enriquecimento de OCR",
    "4 novo cortador padronizador image.py",
    "5 imagem link github"
]

# Executa cada script em sequência
for script in scripts:
    script_path = os.path.join(CODIGOS_DIR, script)
    print(f"Executando: {script_path}")
    result = subprocess.run(["python3", script_path], capture_output=True, text=True)
    print(result.stdout)
    if result.returncode != 0:
        print(f"Erro ao executar {script}:")
        print(result.stderr)
        break

# Após rodar todos, faz commit e push do repositório
os.chdir(ECOMMERCE_DIR)
subprocess.run(["git", "add", "."], check=True)
msg = f"Atualização automática diária {datetime.now().strftime('%Y-%m-%d %H:%M')}"
subprocess.run(["git", "commit", "-m", msg], check=True)
subprocess.run(["git", "push"], check=True)
print("Commit e push realizados com sucesso!")